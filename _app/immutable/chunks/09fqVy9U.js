import{v as E,w as O,x as g,y as L,z as P,A as T,h as S,j as M,B as k,D as w,q as B,e as N,E as Y,F as x,G as F,I as C,n as U,J as y,K as q,L as z,P as G,M as m,N as $,O as j,g as H,Q as J,R as K,S as Q,T as V,d as W,U as X,V as Z,W as ee,X as te,Y as se}from"./b2JcXBQY.js";class ae{anchor;#t=new Map;#s=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,a=!0){this.anchor=e,this.#r=a}#i=()=>{var e=E;if(this.#t.has(e)){var a=this.#t.get(e),t=this.#s.get(a);if(t)O(t),this.#a.delete(a);else{var n=this.#e.get(a);n&&(this.#s.set(a,n.effect),this.#e.delete(a),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),t=n.effect)}for(const[r,s]of this.#t){if(this.#t.delete(r),r===e)break;const i=this.#e.get(s);i&&(g(i.effect),this.#e.delete(s))}for(const[r,s]of this.#s){if(r===a||this.#a.has(r))continue;const i=()=>{if(Array.from(this.#t.values()).includes(r)){var d=document.createDocumentFragment();k(s,d),d.append(P()),this.#e.set(r,{effect:s,fragment:d})}else g(s);this.#a.delete(r),this.#s.delete(r)};this.#r||!t?(this.#a.add(r),L(s,i,!1)):i()}}};#n=e=>{this.#t.delete(e);const a=Array.from(this.#t.values());for(const[t,n]of this.#e)a.includes(t)||(g(n.effect),this.#e.delete(t))};ensure(e,a){var t=E,n=w();if(a&&!this.#s.has(e)&&!this.#e.has(e))if(n){var r=document.createDocumentFragment(),s=P();r.append(s),this.#e.set(e,{effect:T(()=>a(s)),fragment:r})}else this.#s.set(e,T(()=>a(this.anchor)));if(this.#t.set(t,e),n){for(const[i,c]of this.#s)i===e?t.skipped_effects.delete(c):t.skipped_effects.add(c);for(const[i,c]of this.#e)i===e?t.skipped_effects.delete(c.effect):t.skipped_effects.add(c.effect);t.oncommit(this.#i),t.ondiscard(this.#n)}else S&&(this.anchor=M),this.#i()}}function ne(f,e,a=!1){S&&N();var t=new ae(f),n=a?Y:0;function r(s,i){if(S){const d=x(f)===F;if(s===d){var c=C();U(c),t.anchor=c,y(!1),t.ensure(s,i),y(!0);return}}t.ensure(s,i)}B(()=>{var s=!1;e((i,c=!0)=>{s=!0,r(c,i)}),s||r(!1,null)},n)}let v=!1;function re(f){var e=v;try{return v=!1,[f(),v]}finally{v=e}}function fe(f,e,a,t){var n=(a&V)!==0,r=(a&Z)!==0,s=t,i=!0,c=()=>(i&&(i=!1,s=r?W(t):t),s),d;if(n){var I=te in f||se in f;d=q(f,e)?.set??(I&&e in f?h=>f[e]=h:void 0)}var u,p=!1;n?[u,p]=re(()=>f[e]):u=f[e],u===void 0&&t!==void 0&&(u=c(),d&&(z(),d(u)));var o;if(o=()=>{var h=f[e];return h===void 0?c():(i=!0,h)},(a&G)===0)return o;if(d){var R=f.$$legacy;return(function(h,l){return arguments.length>0?((!l||R||p)&&d(l?o():h),h):o()})}var b=!1,_=((a&X)!==0?K:Q)(()=>(b=!1,o()));n&&m(_);var D=H;return(function(h,l){if(arguments.length>0){const A=l?m(_):n?$(h):h;return j(_,A),b=!0,s!==void 0&&(s=A),h}return ee&&b||(D.f&J)!==0?_.v:m(_)})}export{ae as B,ne as i,fe as p};
